{"version":3,"sources":["../../../app/middleware/error_middleware.js"],"names":["require","BAD_REQUEST","UNAUTHORIZED","FORBIDDEN","CONFLICT","NOT_FOUND","UNPROCESSABLE","GENERIC_ERROR","unauthorized","err","req","res","next","status","send","error","message","errors","forbidden","conflict","hasErrors","Object","entries","length","constructor","badRequest","unprocessable","notFound","genericError","console","log","catchall","exportables","all","keys","map","key","module","exports"],"mappings":"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","sourcesContent":["'use strict'\n\nconst {\n  BAD_REQUEST,\n  UNAUTHORIZED,\n  FORBIDDEN,\n  CONFLICT,\n  NOT_FOUND,\n  UNPROCESSABLE,\n  GENERIC_ERROR\n} = require('../helpers/error_helper')\n\nconst unauthorized = (err, req, res, next) => {\n  if (err.status !== UNAUTHORIZED) return next(err)\n  delete err.status;\n  res.status(UNAUTHORIZED).send({\n    error: true,\n    message: err.message || 'Unauthorized',\n    errors: [err]\n  })\n}\n\nconst forbidden = (err, req, res, next) => {\n  if (err.status !== FORBIDDEN) return next(err)\n  delete err.status;\n  res.status(FORBIDDEN).send({\n    error: true,\n    message: err.message || 'Forbidden',\n    errors: [err]\n  })\n}\n\nconst conflict = (err, req, res, next) => {\n  if (err.status !== CONFLICT) return next(err)\n  delete err.status;\n\n  let error = {\n    error: true,\n    message: err.message || 'Conflict'\n  };\n\n  const hasErrors= Object.entries(err).length === 0 && err.constructor === Object;\n  if(hasErrors){\n    error.errors = [err];\n  }\n\n  res.status(CONFLICT).send(error)\n}\n\nconst badRequest = (err, req, res, next) => {\n  if (err.status !== BAD_REQUEST) return next(err)\n  delete err.status;\n\n  let error = {\n    error: true,\n    message: err.message || 'Bad Request'\n  };\n\n  const hasErrors= Object.entries(err).length === 0 && err.constructor === Object;\n  if(hasErrors){\n    error.errors = [err];\n  }\n\n  res.status(BAD_REQUEST).send(error)\n}\n\nconst unprocessable = (err, req, res, next) => {\n  if (err.status !== UNPROCESSABLE) return next(err)\n  delete err.status;\n\n  let error = {\n    error: true,\n    message: err.message || 'Unprocessable entity'\n  };\n\n  const hasErrors= Object.entries(err).length === 0 && err.constructor === Object;\n  if(hasErrors){\n    error.errors = [err];\n  }\n\n  res.status(UNPROCESSABLE).send(error)\n}\n\n// If there's nothing left to do after all this (and there's no error),\n// return a 404 error.\nconst notFound = (err, req, res, next) => {\n  if (err.status !== NOT_FOUND) return next(err)\n  delete err.status;\n  res.status(NOT_FOUND).send({\n    error: true,\n    message: err.message || 'The requested resource could not be found'\n  })\n}\n\n// If there's still an error at this point, return a generic 500 error.\nconst genericError = (err, req, res, next) => {\n  console.log(err);\n  delete err.status;\n  res.status(GENERIC_ERROR).send({\n    error: true,\n    message: err.message || 'Internal server error',\n    errors: [err]\n  })\n}\n\n// If there's nothing left to do after all this (and there's no error),\n// return a 404 error.\nconst catchall = (req, res, next) => {\n  res.status(NOT_FOUND).send({\n    error: true,\n    message: 'The requested resource could not be found'\n  })\n}\n\nconst exportables = {\n  unauthorized,\n  forbidden,\n  conflict,\n  badRequest,\n  unprocessable,\n  genericError,\n  notFound,\n  catchall\n}\n\n// All exportables stored as an array (e.g., for including in Express app.use())\nconst all = Object.keys(exportables).map(key => exportables[key])\n\nmodule.exports = {\n  ...exportables,\n  all\n}\n"],"file":"error_middleware.js"}